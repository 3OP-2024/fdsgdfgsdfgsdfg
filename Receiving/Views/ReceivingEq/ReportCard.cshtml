@model IEnumerable<Receiving.Models.V_WH_StockCardReport>

<div class="container mt-4">
    <h4 class="mb-3"><i class="ti ti-clipboard-list me-2"></i> รายงานสินค้าคงคลัง (Stock Card)</h4>
    <form method="get" id="formSearch">

        <!-- ฟอร์มค้นหา -->
        <div class="card mb-4 shadow-sm">
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-2 text-end">
                        <label class="form-label">Zone</label>

                    </div>
                    <div class="col-md-2 text-start">
                        <select id="ZoneID" name="ZoneID" class="form-select" asp-items="@ViewBag.Zone">
                            <option value="">เลือก</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <button type="submit" class="btn btn-primary">
                            <i class="ti ti-search me-1"></i> ค้นหา
                        </button>
                        <a href='@Url.Action("Index","Home")' class="btn btn-outline-danger" role="button"><i class="mdi mdi-close-circle-outline"></i> ปิดหน้านี้</a>
                    </div>
                </div>
                <div class="text-end mt-3">


                </div>
            </div>
        </div>
    </form>
        <!-- Stock Card รายการ -->
    <div class="row g-3">


        @foreach (var item in Model)
        {
            string border = "";
            string bg = "";
            string text = "";

            if (item?.TotalQuantity == 0) // ❌ ของหมด
            {
                border = "border-danger";
                bg = "bg-danger-lt";
                text = "text-danger";
            }
            else if (item?.TotalQuantity <= 10) // ⚠️ ใกล้หมด (กำหนด threshold = 10)
            {
                border = "border-warning";
                bg = "bg-warning-lt";
                text = "text-warning";
            }
            else // ✅ เหลือเยอะ
            {
                border = "border-success";
                bg = "bg-success-lt";
                text = "text-success";
            }

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm @border @bg">
                    <div class="card-body">
                        <h6 class="@text fw-bold fs-4">
                            <i class="ti ti-package me-2"></i>@item?.CodeID - @item?.CodeName
                        </h6>

                        <p class="mb-1 text-success">
                            <i class="ti ti-arrow-down-left me-1"></i> รับเข้า: +@item?.TotalQtyReceived
                        </p>
                        <p class="mb-1 text-danger">
                            <i class="ti ti-arrow-up-right me-1"></i> จ่ายออก: -@item?.TotalQtyPay
                        </p>
                        <p class="fw-bold">
                            <i class="ti ti-archive me-1"></i> คงเหลือ:
                            <span class="text-dark">@item?.TotalQuantity</span>
                        </p>


                    </div>

                    <!-- ปุ่ม Export -->
                    @*<div class="mt-4 text-end">
                        <button class="btn btn-outline-success">
                            <i class="ti ti-file-spreadsheet me-1"></i> ส่งออก Excel
                        </button>
                        <button class="btn btn-outline-danger">
                            <i class="ti ti-file-pdf me-1"></i> ส่งออก PDF
                        </button>
                    </div>*@
                </div> 
            
            </div> 
        }
    </div>
